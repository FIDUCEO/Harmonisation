(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     30913,        747]
NotebookOptionsPosition[     28748,        672]
NotebookOutlinePosition[     29162,        690]
CellTagsIndexPosition[     29119,        687]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "A Template to Create Harmonisation Plots with ",
 StyleBox["Mathematica",
  FontSlant->"Italic"]
}], "Title",
 CellChangeTimes->{{3.703485057593796*^9, 3.703485084453247*^9}, 
   3.7034851237872143`*^9}],

Cell["\<\
This work was undertaken within the project \[OpenCurlyDoubleQuote]Fidelity \
and Uncertainty in Climate data records from Earth Observation\
\[CloseCurlyDoubleQuote] (FIDUCEO). FIDUCEO has received funding from the \
European Union\[CloseCurlyQuote]s H2020 Research and Innovation programme, \
under Grant Agreement 638822.\
\>", "Text",
 CellChangeTimes->{3.7034868718845987`*^9, 3.703495415008472*^9}],

Cell[CellGroupData[{

Cell["How to use this template?", "Section",
 CellChangeTimes->{{3.703243100598578*^9, 3.703243104215357*^9}, {
   3.7033196830067377`*^9, 3.703319700045059*^9}, 3.703319730776149*^9, {
   3.703482625880747*^9, 3.7034826268831673`*^9}, {3.70348513796059*^9, 
   3.703485138168635*^9}, {3.703489590508238*^9, 3.7034895927197227`*^9}, {
   3.703489628493743*^9, 3.703489634980667*^9}}],

Cell[TextData[{
 "Place the HarmonisationPlots package into a directory searched by ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "."
}], "ItemNumbered",
 CellChangeTimes->{{3.7034832116285353`*^9, 3.703483244371187*^9}, {
  3.703483333021867*^9, 3.70348340193731*^9}, {3.703489675327406*^9, 
  3.703489675785994*^9}}],

Cell[BoxData[
 RowBox[{"<<", "HarmonisationPlots`"}]], "Input",
 CellChangeTimes->{{3.703228505666198*^9, 3.703228510471408*^9}, {
  3.703228582296434*^9, 3.703228592852488*^9}, {3.7032296827944307`*^9, 
  3.703229689723374*^9}}],

Cell["\<\
Edit the cell below to set the number of harmonisation parameters per sensor.\
\
\>", "ItemNumbered",
 CellChangeTimes->{{3.7034832116285353`*^9, 3.703483244371187*^9}, {
  3.703483492409885*^9, 3.703483505140524*^9}, {3.7034852068627663`*^9, 
  3.703485217281692*^9}, {3.7034879123187304`*^9, 3.703487942011133*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sensorParameterNumber", "=", "4"}], ";"}]], "Input",
 CellChangeTimes->{{3.703487945319365*^9, 3.703487962487824*^9}, {
  3.703489719457919*^9, 3.7034897211510363`*^9}}],

Cell["\<\
Edit the cell below to set the path to the directory where your harmonization \
output data data reside. The directory must contain the parameter and \
residuals datasets from a single harmonisation job.\
\>", "ItemNumbered",
 CellChangeTimes->{{3.7034832116285353`*^9, 3.703483244371187*^9}, {
  3.703483492409885*^9, 3.703483505140524*^9}, {3.7034852068627663`*^9, 
  3.703485217281692*^9}, {3.703590042267261*^9, 3.703590148008461*^9}, {
  3.703590414805244*^9, 3.7035905094904613`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "SetDirectory", "[", 
   "\"\</path/to/the/harmonisation/job/output/data/directory\>\"", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.702282413442349*^9, 3.7022824240200787`*^9}, {
   3.7029633676426573`*^9, 3.702963395946211*^9}, 3.7033179198233423`*^9, 
   3.703319621328933*^9, {3.7034837880637093`*^9, 3.703483823998508*^9}, {
   3.703583699790305*^9, 3.703583713830944*^9}, {3.703585835546171*^9, 
   3.703585850746058*^9}, {3.703586264468678*^9, 3.703586266694193*^9}, {
   3.7035905368236647`*^9, 3.70359053756038*^9}}],

Cell["Evaluate this notebook.", "ItemNumbered",
 CellChangeTimes->{{3.703590169477845*^9, 3.703590176302195*^9}, {
  3.703590263146962*^9, 3.703590342270567*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Preparation", "Section",
 CellChangeTimes->{{3.703243100598578*^9, 3.703243104215357*^9}, {
   3.7033196830067377`*^9, 3.703319700045059*^9}, 3.703319730776149*^9, {
   3.703482625880747*^9, 3.7034826268831673`*^9}, {3.70348513796059*^9, 
   3.703485138168635*^9}, {3.703489590508238*^9, 3.7034895927197227`*^9}, {
   3.703489628493743*^9, 3.703489634980667*^9}, {3.703590191739871*^9, 
   3.7035902017385674`*^9}, {3.7035902520857563`*^9, 3.703590254672139*^9}}],

Cell[BoxData[
 RowBox[{"parameterDatasetName", "=", 
  RowBox[{"First", "[", 
   RowBox[{"FileNames", "[", 
    RowBox[{
    "RegularExpression", "[", 
     "\"\<harm_.*[[:digit:]]{8}_[[:digit:]]{8}.nc\>\"", "]"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7035838636703367`*^9, 3.7035838809576473`*^9}, {
  3.703584066071073*^9, 3.703584149804027*^9}, {3.7035841805650587`*^9, 
  3.703584263120727*^9}, {3.7035843009629707`*^9, 3.7035843095663443`*^9}, {
  3.703584426127901*^9, 3.7035844409240627`*^9}, {3.7035845243347588`*^9, 
  3.703584529563551*^9}, {3.703584562213025*^9, 3.703584787959584*^9}, {
  3.7035849219691143`*^9, 3.703584989925099*^9}, {3.703585043508883*^9, 
  3.7035850626675987`*^9}, {3.7035852317608213`*^9, 3.703585347910693*^9}, {
  3.703586172687483*^9, 3.703586173671743*^9}}],

Cell[BoxData[
 RowBox[{"residualsDatasetNames", "=", 
  RowBox[{"FileNames", "[", 
   RowBox[{
   "RegularExpression", "[", 
    "\"\<harm_.*[[:digit:]]{8}_[[:digit:]]{8}_res_.*.nc\>\"", "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7033101723271646`*^9, 3.703310198290502*^9}, {
   3.7033125631559753`*^9, 3.703312566779585*^9}, {3.703585316585052*^9, 
   3.703585319485981*^9}, {3.703585513811117*^9, 3.7035855543496304`*^9}, 
   3.703585711712043*^9, {3.703586176603965*^9, 3.703586177766588*^9}}],

Cell[BoxData[
 RowBox[{"titles", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"residualsDatasetNames", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"RegularExpression", "[", "\"\<.*_res_\>\"", "]"}], 
           "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
        RowBox[{"\"\<.nc\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
      RowBox[{"\"\<_\>\"", "\[Rule]", "\"\< \>\""}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "residualDatasetNames", "]"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7034820778883657`*^9, 3.703482139896215*^9}, {
   3.703482170696649*^9, 3.703482226083393*^9}, {3.703482263176256*^9, 
   3.703482324119319*^9}, {3.703482396277584*^9, 3.703482419204629*^9}, {
   3.703482463117951*^9, 3.703482468517797*^9}, {3.703482528293364*^9, 
   3.703482565714032*^9}, {3.7035856640294657`*^9, 3.70358566899401*^9}, 
   3.70358571741479*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Correlation matrix", "Section",
 CellChangeTimes->{{3.7029781241418962`*^9, 3.702978127451058*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"parameterDatasetName", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Datasets\>\"", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<parameter_correlation_matrix\>\"", ",", 
         "\"\<parameter_sensors\>\""}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.702282445201152*^9, 3.702282461051414*^9}, {
   3.702963413393179*^9, 3.702963466091954*^9}, {3.702963952425222*^9, 
   3.702963961205822*^9}, 3.702964008798872*^9, {3.703010257682597*^9, 
   3.7030102599779387`*^9}, {3.703010312964388*^9, 3.703010316806901*^9}, {
   3.703318114145275*^9, 3.7033181207524233`*^9}, 3.70331964918902*^9, {
   3.7034304646028347`*^9, 3.703430489382072*^9}, 3.7035856192997303`*^9}],

Cell[BoxData[
 RowBox[{"plotCorrelationMatrix", "[", 
  RowBox[{"data", ",", 
   RowBox[{"ParameterGrouping", "\[Rule]", "sensorParameterNumber"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7022827193716793`*^9, 3.70228272620796*^9}, {
   3.702283563501959*^9, 3.702283636759019*^9}, {3.702283680493944*^9, 
   3.702283695257389*^9}, {3.7022837342306643`*^9, 3.702283768137376*^9}, 
   3.7022838097020597`*^9, {3.7029634888388777`*^9, 3.702963490198248*^9}, 
   3.702963525714901*^9, {3.7029636355056543`*^9, 3.702963641317017*^9}, {
   3.7029636875547028`*^9, 3.702963729331395*^9}, {3.7029637680972223`*^9, 
   3.702963821230838*^9}, {3.70296387015199*^9, 3.702963901441452*^9}, {
   3.702963994546707*^9, 3.7029640015874863`*^9}, {3.7029640483237953`*^9, 
   3.702964059994632*^9}, {3.702964145303103*^9, 3.7029641481993227`*^9}, {
   3.702999536524222*^9, 3.702999542656519*^9}, {3.703003036498714*^9, 
   3.703003058419396*^9}, {3.703003107070998*^9, 3.7030031634700527`*^9}, 
   3.7030079258075333`*^9, {3.7030088006088467`*^9, 3.703008801722172*^9}, {
   3.7030088787787333`*^9, 3.7030088809550867`*^9}, {3.703058052374588*^9, 
   3.703058174438757*^9}, {3.703058310115528*^9, 3.703058347895576*^9}, 
   3.703059338483027*^9, {3.7030594784770927`*^9, 3.703059498372574*^9}, {
   3.703059545229177*^9, 3.703059553650733*^9}, {3.703224057260964*^9, 
   3.703224066160101*^9}, {3.703228608643021*^9, 3.703228613415041*^9}, {
   3.703429574538598*^9, 3.703429591573601*^9}, {3.703429987421389*^9, 
   3.703430044531292*^9}, {3.7034301004*^9, 3.703430139085394*^9}, {
   3.703430283039625*^9, 3.7034303584720297`*^9}, {3.703430899854*^9, 
   3.7034309002589493`*^9}, {3.703483656434144*^9, 3.703483680292877*^9}, {
   3.703487971805456*^9, 3.7034879769864817`*^9}, {3.703489729188283*^9, 
   3.7034897506773853`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Covariance matrix", "Section",
 CellChangeTimes->{{3.7029781241418962`*^9, 3.7029781384808292`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"parameterDatasetName", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Datasets\>\"", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<parameter_covariance_matrix\>\"", ",", 
         "\"\<parameter_sensors\>\""}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.702282445201152*^9, 3.702282461051414*^9}, {
   3.702963413393179*^9, 3.702963466091954*^9}, {3.702963952425222*^9, 
   3.702963961205822*^9}, 3.702964008798872*^9, {3.703010257682597*^9, 
   3.7030102599779387`*^9}, {3.703010312964388*^9, 3.703010316806901*^9}, 
   3.703318136456522*^9, 3.7033196564030447`*^9, 3.703433307143279*^9, 
   3.703585633641616*^9}],

Cell[BoxData[
 RowBox[{"plotCovarianceMatrix", "[", 
  RowBox[{"data", ",", 
   RowBox[{"ParameterGrouping", "\[Rule]", "sensorParameterNumber"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7022827193716793`*^9, 3.70228272620796*^9}, {
   3.702283563501959*^9, 3.702283636759019*^9}, {3.702283680493944*^9, 
   3.702283695257389*^9}, {3.7022837342306643`*^9, 3.702283768137376*^9}, 
   3.7022838097020597`*^9, {3.7029634888388777`*^9, 3.702963490198248*^9}, 
   3.702963525714901*^9, {3.7029636355056543`*^9, 3.702963641317017*^9}, {
   3.7029636875547028`*^9, 3.702963729331395*^9}, {3.7029637680972223`*^9, 
   3.702963821230838*^9}, {3.70296387015199*^9, 3.702963901441452*^9}, {
   3.702963994546707*^9, 3.7029640015874863`*^9}, {3.7029640483237953`*^9, 
   3.702964059994632*^9}, {3.702964145303103*^9, 3.7029641481993227`*^9}, {
   3.702999536524222*^9, 3.702999542656519*^9}, {3.703003036498714*^9, 
   3.703003058419396*^9}, {3.703003107070998*^9, 3.7030031634700527`*^9}, 
   3.7030079258075333`*^9, {3.7030088006088467`*^9, 3.703008801722172*^9}, {
   3.7030088787787333`*^9, 3.7030088809550867`*^9}, {3.703058052374588*^9, 
   3.703058174438757*^9}, 3.703058228894948*^9, {3.703058267651219*^9, 
   3.703058268240921*^9}, 3.703059344774433*^9, {3.703059561789572*^9, 
   3.703059565756315*^9}, {3.703224123606494*^9, 3.7032241315167713`*^9}, {
   3.703228628912237*^9, 3.703228633459714*^9}, {3.703483687938799*^9, 
   3.703483697017906*^9}, {3.703487980684279*^9, 3.703487984684387*^9}, {
   3.703489731553247*^9, 3.703489755439805*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mean residuals", "Section",
 CellChangeTimes->{{3.7029781241418962`*^9, 3.7029781384808292`*^9}, {
   3.702982168490472*^9, 3.702982173001381*^9}, {3.702985498495274*^9, 
   3.702985518317214*^9}, {3.7029861339022627`*^9, 3.702986139623098*^9}, {
   3.703002613987823*^9, 3.7030026371990833`*^9}, {3.703006041496833*^9, 
   3.703006044771619*^9}, {3.703218748971777*^9, 3.703218754023712*^9}, {
   3.703226683782563*^9, 3.703226688163557*^9}, 3.70322868617083*^9, {
   3.703313339823312*^9, 3.7033133415699043`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"parameterDatasetName", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Datasets\>\"", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<k_res_mean\>\"", ",", "\"\<k_res_mean_stdev\>\"", ",", 
         "\"\<k_res_sensors\>\""}], "}"}]}], "}"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.702282445201152*^9, 3.702282461051414*^9}, {
   3.702963413393179*^9, 3.702963466091954*^9}, {3.702963952425222*^9, 
   3.702963961205822*^9}, 3.702964008798872*^9, {3.703010257682597*^9, 
   3.7030102599779387`*^9}, {3.703010312964388*^9, 3.703010316806901*^9}, {
   3.703218784857417*^9, 3.703218824088835*^9}, 3.703219434649494*^9, {
   3.703220052368106*^9, 3.703220060019335*^9}, {3.70322205260244*^9, 
   3.7032220541196337`*^9}, 3.703318151677669*^9, 3.703319664097575*^9, 
   3.7035857060533447`*^9}],

Cell[BoxData[
 RowBox[{"plotMeanResiduals", "[", 
  RowBox[{"data", ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.45"}], ",", "0.45"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.703225284915181*^9, 3.703225289490675*^9}, {
   3.703225915584051*^9, 3.7032260021249647`*^9}, 3.703226906932663*^9, {
   3.703228646432152*^9, 3.7032286527453213`*^9}, {3.703307529088849*^9, 
   3.703307537756095*^9}, 3.7033076478432217`*^9, {3.7033077795956907`*^9, 
   3.703307834978712*^9}, {3.703307976130207*^9, 3.703307999913031*^9}, {
   3.703312598514873*^9, 3.70331259977039*^9}, {3.703313348151987*^9, 
   3.703313350021563*^9}, {3.7033181789804497`*^9, 3.703318238973323*^9}, {
   3.703319845794682*^9, 3.70331984939102*^9}, {3.7033201830605917`*^9, 
   3.703320198583502*^9}, {3.70332024643785*^9, 3.703320285643777*^9}, {
   3.7034357400165787`*^9, 3.7034357513511467`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Radiance vs radiance", "Section",
 CellChangeTimes->{{3.7029781241418962`*^9, 3.7029781384808292`*^9}, {
   3.702982168490472*^9, 3.702982173001381*^9}, {3.702985498495274*^9, 
   3.702985518317214*^9}, {3.703005326942132*^9, 3.703005340861847*^9}, 
   3.7033130645854*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Import", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Datasets\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<measurand_i\>\"", ",", "\"\<measurand_j\>\""}], 
            "}"}]}], "}"}]}], "]"}], ")"}], "&"}], ",", 
     "residualsDatasetNames"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.703310218903105*^9, 3.703310332287218*^9}, 
   3.703585738741436*^9}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"plotRadianceVsRadiance", "[", 
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"5", ",", "155"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", "155"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Title", "\[Rule]", 
        RowBox[{"titles", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"360", ",", "Automatic"}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7033105529508257`*^9, 3.703310606173193*^9}, {
   3.703310798109202*^9, 3.703310801375951*^9}, {3.703311096369885*^9, 
   3.70331113650329*^9}, {3.703311169812378*^9, 3.7033112027234507`*^9}, 
   3.703311314237624*^9, {3.703311347441064*^9, 3.703311348893058*^9}, {
   3.703311713080222*^9, 3.703311737719377*^9}, {3.703311786546546*^9, 
   3.703311811156289*^9}, {3.7033118536078463`*^9, 3.703311857846787*^9}, {
   3.703312001537446*^9, 3.703312002883132*^9}, {3.703312095036326*^9, 
   3.7033121125688667`*^9}, {3.703312155690723*^9, 3.703312160549822*^9}, {
   3.703312238140176*^9, 3.703312240450651*^9}, {3.703312413574438*^9, 
   3.7033124145592213`*^9}, 3.703312742771037*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Residuals vs time", "Section",
 CellChangeTimes->{{3.7029781241418962`*^9, 3.7029781384808292`*^9}, {
   3.702982168490472*^9, 3.702982173001381*^9}, {3.702985498495274*^9, 
   3.702985518317214*^9}, {3.7029861339022627`*^9, 3.702986139623098*^9}, {
   3.703002613987823*^9, 3.703002622301326*^9}, {3.703005309829156*^9, 
   3.70300531712862*^9}, {3.703005351000716*^9, 3.703005351943376*^9}, 
   3.703228853946342*^9, 3.703313067858633*^9, {3.703313362194282*^9, 
   3.703313363689329*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Import", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Datasets\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<t\>\"", ",", "\"\<k_res\>\""}], "}"}]}], "}"}]}], 
        "]"}], ")"}], "&"}], ",", "residualsDatasetNames"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.703310218903105*^9, 3.703310332287218*^9}, {
   3.703312719480535*^9, 3.7033127266422453`*^9}, 3.703585744932467*^9}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"plotResidualsVsTime", "[", 
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1981", ",", "2019"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Title", "\[Rule]", 
        RowBox[{"titles", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"360", ",", "Automatic"}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7033105529508257`*^9, 3.703310606173193*^9}, {
   3.703310798109202*^9, 3.703310801375951*^9}, {3.703311096369885*^9, 
   3.70331113650329*^9}, {3.703311169812378*^9, 3.7033112027234507`*^9}, 
   3.703311314237624*^9, {3.703311347441064*^9, 3.703311348893058*^9}, {
   3.703311713080222*^9, 3.703311737719377*^9}, {3.703311786546546*^9, 
   3.703311811156289*^9}, {3.7033118536078463`*^9, 3.703311857846787*^9}, {
   3.703312001537446*^9, 3.703312002883132*^9}, {3.703312095036326*^9, 
   3.7033121125688667`*^9}, {3.703312155690723*^9, 3.703312160549822*^9}, {
   3.703312238140176*^9, 3.703312240450651*^9}, {3.703312413574438*^9, 
   3.7033124145592213`*^9}, 3.703312753204948*^9, {3.7033127853843946`*^9, 
   3.703312808856703*^9}, {3.703312886726663*^9, 3.703312894883765*^9}, {
   3.703313366193461*^9, 3.7033133680090446`*^9}, {3.703318573451283*^9, 
   3.703318576866974*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Normalized residuals vs time", "Section",
 CellChangeTimes->{{3.7029781241418962`*^9, 3.7029781384808292`*^9}, {
   3.702982168490472*^9, 3.702982173001381*^9}, {3.702985498495274*^9, 
   3.702985518317214*^9}, {3.7029861339022627`*^9, 3.702986139623098*^9}, {
   3.703002613987823*^9, 3.703002622301326*^9}, {3.703005309829156*^9, 
   3.70300531712862*^9}, {3.703005351000716*^9, 3.703005351943376*^9}, 
   3.703228853946342*^9, {3.703244167479232*^9, 3.7032441756376762`*^9}, 
   3.703313071089662*^9, {3.703313372716735*^9, 3.703313374658133*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Import", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Datasets\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<t\>\"", ",", "\"\<k_res_normalised\>\""}], "}"}]}], 
          "}"}]}], "]"}], ")"}], "&"}], ",", "residualsDatasetNames"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.703310218903105*^9, 3.703310332287218*^9}, {
   3.703312719480535*^9, 3.7033127266422453`*^9}, {3.7033127724980707`*^9, 
   3.7033127747393436`*^9}, 3.70358574737449*^9}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"plotNormalizedResidualsVsTime", "[", 
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1981", ",", "2019"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "7"}], ",", "7"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Title", "\[Rule]", 
        RowBox[{"titles", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"360", ",", "Automatic"}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7033105529508257`*^9, 3.703310606173193*^9}, {
   3.703310798109202*^9, 3.703310801375951*^9}, {3.703311096369885*^9, 
   3.70331113650329*^9}, {3.703311169812378*^9, 3.7033112027234507`*^9}, 
   3.703311314237624*^9, {3.703311347441064*^9, 3.703311348893058*^9}, {
   3.703311713080222*^9, 3.703311737719377*^9}, {3.703311786546546*^9, 
   3.703311811156289*^9}, {3.7033118536078463`*^9, 3.703311857846787*^9}, {
   3.703312001537446*^9, 3.703312002883132*^9}, {3.703312095036326*^9, 
   3.7033121125688667`*^9}, {3.703312155690723*^9, 3.703312160549822*^9}, {
   3.703312238140176*^9, 3.703312240450651*^9}, {3.703312413574438*^9, 
   3.7033124145592213`*^9}, {3.703312789658844*^9, 3.703312812914466*^9}, {
   3.703312897836474*^9, 3.703312904823629*^9}, {3.703313377035213*^9, 
   3.703313378925243*^9}, {3.70331863526851*^9, 3.703318639543458*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Histogram of residuals", "Section",
 CellChangeTimes->{{3.7029781241418962`*^9, 3.7029781384808292`*^9}, {
   3.702982168490472*^9, 3.702982173001381*^9}, {3.702985498495274*^9, 
   3.702985518317214*^9}, {3.7029861339022627`*^9, 3.702986139623098*^9}, {
   3.703002613987823*^9, 3.7030026371990833`*^9}, {3.703006041496833*^9, 
   3.703006044771619*^9}, 3.703228907141306*^9, {3.703313109584703*^9, 
   3.7033131111347017`*^9}, {3.703313385779435*^9, 3.7033133893068047`*^9}, {
   3.703313511599908*^9, 3.703313521880269*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Import", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Datasets\>\"", ",", "\"\<k_res\>\""}], "}"}]}], "]"}], 
       ")"}], "&"}], ",", "residualsDatasetNames"}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.703310218903105*^9, 3.703310332287218*^9}, {
   3.703312719480535*^9, 3.7033127266422453`*^9}, {3.7033127724980707`*^9, 
   3.7033127747393436`*^9}, {3.703312921671219*^9, 3.703312926556028*^9}, 
   3.703585750366218*^9}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"plotResidualsHistogram", "[", 
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1.5"}], ",", "1.5"}], "}"}], ",", "Automatic"}], 
         "}"}]}], ",", 
       RowBox[{"Title", "\[Rule]", 
        RowBox[{"titles", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"360", ",", "Automatic"}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7033105529508257`*^9, 3.703310606173193*^9}, {
   3.703310798109202*^9, 3.703310801375951*^9}, {3.703311096369885*^9, 
   3.70331113650329*^9}, {3.703311169812378*^9, 3.7033112027234507`*^9}, 
   3.703311314237624*^9, {3.703311347441064*^9, 3.703311348893058*^9}, {
   3.703311713080222*^9, 3.703311737719377*^9}, {3.703311786546546*^9, 
   3.703311811156289*^9}, {3.7033118536078463`*^9, 3.703311857846787*^9}, {
   3.703312001537446*^9, 3.703312002883132*^9}, {3.703312095036326*^9, 
   3.7033121125688667`*^9}, {3.703312155690723*^9, 3.703312160549822*^9}, {
   3.703312238140176*^9, 3.703312240450651*^9}, {3.703312413574438*^9, 
   3.7033124145592213`*^9}, {3.703312789658844*^9, 3.703312812914466*^9}, {
   3.703312897836474*^9, 3.703312904823629*^9}, {3.7033129445830383`*^9, 
   3.7033129720993977`*^9}, {3.703313393242003*^9, 3.703313394892803*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Histogram of normalized residuals", "Section",
 CellChangeTimes->{{3.7029781241418962`*^9, 3.7029781384808292`*^9}, {
   3.702982168490472*^9, 3.702982173001381*^9}, {3.702985498495274*^9, 
   3.702985518317214*^9}, {3.7029861339022627`*^9, 3.702986139623098*^9}, {
   3.703002613987823*^9, 3.7030026371990833`*^9}, {3.703006041496833*^9, 
   3.703006044771619*^9}, 3.703228907141306*^9, {3.7033130108279467`*^9, 
   3.703313016638937*^9}, {3.703313114674556*^9, 3.703313116314665*^9}, {
   3.703313399612124*^9, 3.703313401384515*^9}, {3.7033135064650497`*^9, 
   3.703313529031167*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Import", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Datasets\>\"", ",", "\"\<k_res_normalised\>\""}], 
          "}"}]}], "]"}], ")"}], "&"}], ",", "residualsDatasetNames"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.703310218903105*^9, 3.703310332287218*^9}, {
   3.703312719480535*^9, 3.7033127266422453`*^9}, {3.7033127724980707`*^9, 
   3.7033127747393436`*^9}, {3.703312921671219*^9, 3.703312926556028*^9}, {
   3.70331302874781*^9, 3.703313031062162*^9}, 3.70358575228132*^9}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"plotNormalizedResidualsHistogram", "[", 
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "3.5"}], ",", "3.5"}], "}"}], ",", "Automatic"}], 
         "}"}]}], ",", 
       RowBox[{"Title", "\[Rule]", 
        RowBox[{"titles", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"360", ",", "Automatic"}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7033105529508257`*^9, 3.703310606173193*^9}, {
   3.703310798109202*^9, 3.703310801375951*^9}, {3.703311096369885*^9, 
   3.70331113650329*^9}, {3.703311169812378*^9, 3.7033112027234507`*^9}, 
   3.703311314237624*^9, {3.703311347441064*^9, 3.703311348893058*^9}, {
   3.703311713080222*^9, 3.703311737719377*^9}, {3.703311786546546*^9, 
   3.703311811156289*^9}, {3.7033118536078463`*^9, 3.703311857846787*^9}, {
   3.703312001537446*^9, 3.703312002883132*^9}, {3.703312095036326*^9, 
   3.7033121125688667`*^9}, {3.703312155690723*^9, 3.703312160549822*^9}, {
   3.703312238140176*^9, 3.703312240450651*^9}, {3.703312413574438*^9, 
   3.7033124145592213`*^9}, {3.703312789658844*^9, 3.703312812914466*^9}, {
   3.703312897836474*^9, 3.703312904823629*^9}, {3.7033129445830383`*^9, 
   3.7033129720993977`*^9}, {3.703313040041933*^9, 3.703313041796021*^9}, {
   3.7033134050904007`*^9, 3.70331341790256*^9}, {3.703318754365746*^9, 
   3.703318757944385*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 755},
WindowMargins->{{Automatic, 243}, {Automatic, 15}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 221, 6, 148, "Title"],
Cell[804, 30, 414, 7, 68, "Text"],
Cell[CellGroupData[{
Cell[1243, 41, 383, 5, 64, "Section"],
Cell[1629, 48, 325, 8, 30, "ItemNumbered"],
Cell[1957, 58, 229, 4, 32, "Input"],
Cell[2189, 64, 327, 6, 30, "ItemNumbered"],
Cell[2519, 72, 204, 4, 32, "Input"],
Cell[2726, 78, 500, 8, 49, "ItemNumbered"],
Cell[3229, 88, 567, 11, 32, "Input"],
Cell[3799, 101, 162, 2, 30, "ItemNumbered"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3998, 108, 469, 6, 64, "Section"],
Cell[4470, 116, 811, 15, 54, "Input"],
Cell[5284, 133, 506, 10, 54, "Input"],
Cell[5793, 145, 1135, 26, 138, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6965, 176, 105, 1, 64, "Section"],
Cell[7073, 179, 789, 17, 54, "Input"],
Cell[7865, 198, 1821, 27, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9723, 230, 106, 1, 64, "Section"],
Cell[9832, 233, 737, 17, 54, "Input"],
Cell[10572, 252, 1550, 23, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12159, 280, 522, 7, 64, "Section"],
Cell[12684, 289, 895, 19, 54, "Input"],
Cell[13582, 310, 924, 16, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14543, 331, 279, 4, 64, "Section"],
Cell[14825, 337, 549, 16, 54, "Input"],
Cell[15377, 355, 1530, 34, 54, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16944, 394, 497, 7, 64, "Section"],
Cell[17444, 403, 574, 16, 32, "Input"],
Cell[18021, 421, 1757, 38, 54, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19815, 464, 556, 7, 64, "Section"],
Cell[20374, 473, 642, 17, 32, "Input"],
Cell[21019, 492, 1736, 37, 54, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22792, 534, 533, 7, 64, "Section"],
Cell[23328, 543, 603, 16, 32, "Input"],
Cell[23934, 561, 1687, 36, 54, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25658, 602, 594, 8, 64, "Section"],
Cell[26255, 612, 664, 16, 32, "Input"],
Cell[26922, 630, 1798, 38, 75, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

